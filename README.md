SpectralTrainFig
================

#### Overview
SpectralTrainFig is a graphical user interface that allows a user to select a folder of EDF/XML files to process. The GUI is configured to apply spectral analysis to the electroencephlography signal (EEG). The default spectral analysis parameters include 10x4 second sub-epochs with a 50% tukey window. Alternatively the user can set the spectral analysis parameters to the ones used for the SHHS study (6x5 second with Hanning window). The user can adjust the artifact detection thresholds, which are preset to reccomended values.  SpectralTrainFig is a user friendly approach to the SpectralAnalysisClass function which provides access to 56 parameters (artifact detection, spectral analysis, and figure configurations). The output includes EXCEL and PowerPoint summaries which are configured by user defined settings and specified spectral bands. Detail epoch by epoch and subject summaries are provided for both NREM and REM states.  

### Parameters

##### Description
*Analysis Description*. Enter a brief analysis description.

*Output File Prefix*. Enter a prefix, which will be used to start each file written by the program.

*Data Folder*. Select a folder containing EDF and XML files

*Results Folder*. Select a folder to write program generated files to.

##### Analysis Parameters
*Analysis Signals*. Enter signal labels that are to be analyzed as a cell string (ex. {'C3', 'C2', 'C3-A1'}. The signal labels are written in the EDF file.  Use your favorite EDF utility to determine the signal labels.  You can use [SignalRasterViewerFig](http://www.mathworks.com/matlabcentral/fileexchange/46420-blockedfsignalrasterview) to list the signal labels and to view the signals.

*Reference Signals*. Enter the labels of the reference signals as a cell string (ex. {'A1', 'M1', 'M2'}).

*Reference Methods*.  Select one of three approaches to referencing the signal.  
-  *Single reference signal*. Enter a single signal label as cell string (ex. {'M1'}).  The reference signal is subtracted from each analysis signal. Entering a null cell string is interpreted as not to reference the analysis signals (ex. {})). 
-  *Reference for each analysis signal*. Enter a reference for each signal as a cell string (ex. {'M1','M1','M2','M3'}). A signal label can be used multiple times.
-  *Average of reference signals*.  The average of the signals listed in the cell array is substracted from each analysis signals.

*Spectral Settings*
-    Default.  The default settings are 10x4 second sub-epochs with a 50% tukey window. A 30 second scoring window is assumed.
-    SHHS.  The settings used for the Sleep Heart Health Study can be selected. The settings are 6x5 second sub-epochs with a hanning window.  A 30 second scoring window is applied.

*Artifact Detection*
-    Delta (0.6-4.6 Hz). Set the multiplicative threshold for the delta band, which defaults to 2.5
-    Beta (40-60 Hz). Set the multiplicative thresold for the beta band, which defaults to 2.0

*Monitor Id*. Select the monitor to display the figures created during processing.

*Start*. Select the file Id to start. The option is provided in order to trouble shoot a failed fun. Review the autogenerated file lists to identify files or review the error message.

##### GUI Funciton Button
*Close All*. Closes all open figures

*About*. Displays graphical user interface description and copyright notice.

*Set Bands*. Load an Excel file with a list of spectral bands to analyze/report on.  Examples of the Excel spreadsheet can be found in the release section.

*Bands*. Start batch processing. Compute and report band summaries by subject and create a summary across subjects.

*Go (min)*. Reccomended batch processing option.  Visual (PPT) and numeric (XLS) summaries are created across subjects.  Visual summary allows for a rapid review of all subjects.

*Go (all)*.  Detail visual (PPT) and numeric (XLS) summaries by subject and across subjects.

*Compute Coherence*. Select check box to compute coherence between each pair of analysis signals.  Warning: the number of signal pair increases rapidly as the number of analysis signals grow. 

### Technical Overview
The functional component of the GUI is implemented as a single class, which builds on the data access classes developed as part of the [Data Access and Visaulization (DAVS) Tooklbox](https://github.com/DennisDean/DAVS-Toolbox). Most of the key components are written as classes. In general, the clases structure used in development provide error checking and visual/numeric reporting cabilities.  The class feautres allows for the rapid development of a lean GUI. The use of PowerPoint and Excel as the standard ouput file type was selected so that research assistants with little programming experience can pre-screen large number of results. Many of the reccomendations for writing fast MATLAB script files are used in the program. The current time to process a single subject is currently 1 to 10 seconds on a medium size work station, depending on the number of outputs written to disk.  

#### MATLAB APP
The MATLAB APP is a great way to get started with spectral analysis of sleep studies. Installing the APP version of SignalRasterView is a quick way to review an EDF's content and to determine the signal labels. See the release section for the MATLAB App and sample data.  

#### Requirements
The memory and hard disk requirements are dependent on the size and number of sleep studies to be analyzed. The program can run on a laptop with 8 Gb of RAM.  The preferred configurtion for a large number of studies is 16-32 Gb of RAM. Similarly, the required disk space is dependent on the number of signals process, the number files selected and the number of ouputs generated by the program. 

#### Acknowledgments
SpectralTrainFig uses several utilities available from the MATLAB file exchange area including:
-    [dirr](http://www.mathworks.com/matlabcentral/fileexchange/8682-dirr--find-files-recursively-filtering-name--date-or-bytes-) Used to create EDF/XMl file lists for processing
-    [moving](http://www.mathworks.com/matlabcentral/fileexchange/8251-moving-averages---moving-median-etc). Used to compute running band averages for the artifact detection computations.
-    [panel](http://www.mathworks.com/matlabcentral/fileexchange/20003-panel). Used to create a summary figure for review.
-    [saveppt2](http://www.mathworks.com/matlabcentral/fileexchange/19322-saveppt2). Used to create PPT summaries from MATLAB figures.

